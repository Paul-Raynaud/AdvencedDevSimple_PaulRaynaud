### AdvancedDevSample API - Collection de tests
### Base URL
@baseUrl = http://localhost:5069
@productId = 
@token = 

### ============================================
### AUTHENTIFICATION
### ============================================

### 1. Login - Obtenir un token JWT
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "username": "admin",
  "password": "password"
}

### Après avoir exécuté la requête ci-dessus, copiez le token de la réponse
### et remplacez @token ci-dessus par: @token = votre_token_ici

### ============================================
### GESTION DES PRODUITS (Requiert authentification)
### ============================================

### 2. Créer un produit
POST {{baseUrl}}/api/products
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "price": 99.99
}

### 3. Créer un autre produit
POST {{baseUrl}}/api/products
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "price": 149.99
}

### 4. Obtenir tous les produits
GET {{baseUrl}}/api/products
Authorization: Bearer {{token}}

### 5. Obtenir un produit par ID (remplacer {id} par un GUID réel)
GET {{baseUrl}}/api/products/00000000-0000-0000-0000-000000000000
Authorization: Bearer {{token}}

### 5. Obtenir un produit par ID (remplacer {id} par un GUID réel)
GET {{baseUrl}}/api/products/00000000-0000-0000-0000-000000000000
Authorization: Bearer {{token}}

### 6. Mettre à jour un produit (remplacer {id} par un GUID réel)
PUT {{baseUrl}}/api/products/00000000-0000-0000-0000-000000000000
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "price": 199.99,
  "isActive": true
}

### 7. Changer uniquement le prix (remplacer {id} par un GUID réel)
PUT {{baseUrl}}/api/products/00000000-0000-0000-0000-000000000000/price
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "newPrice": 299.99
}

### 8. Supprimer un produit (remplacer {id} par un GUID réel)
DELETE {{baseUrl}}/api/products/00000000-0000-0000-0000-000000000000
Authorization: Bearer {{token}}

### ============================================
### TESTS D'ERREURS
### ============================================

### 9. Test avec un prix invalide (devrait retourner 400)
POST {{baseUrl}}/api/products
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "price": -10
}

### 10. Test avec un prix zéro (devrait retourner 400)
POST {{baseUrl}}/api/products
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "price": 0
}

### 11. Obtenir un produit inexistant (devrait retourner 404)
GET {{baseUrl}}/api/products/99999999-9999-9999-9999-999999999999
Authorization: Bearer {{token}}

### 12. Créer un produit, le désactiver, puis essayer de changer le prix
# Étape 1 : Créer
POST {{baseUrl}}/api/products
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "price": 100.00
}

###
# Étape 2 : Désactiver (copier l'ID du produit créé ci-dessus)
PUT {{baseUrl}}/api/products/REPLACE_WITH_REAL_ID
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "price": 100.00,
  "isActive": false
}

###
# Étape 3 : Essayer de changer le prix (devrait retourner 400 - Bad Request)
PUT {{baseUrl}}/api/products/REPLACE_WITH_REAL_ID/price
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "newPrice": 200.00
}
